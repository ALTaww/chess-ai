"use strict";(self.webpackChunkstockfish_web=self.webpackChunkstockfish_web||[]).push([[11],{11:(e,n,o)=>{o.r(n),o.d(n,{default:()=>b});var s=o(371);const t="StockfishOnlineChessboard_StockfishOnlineChessboard__Xm861",c="StockfishOnlineChessboard_chessboardWrapper__LJGcy",r="StockfishOnlineChessboard_buttons__0Mnm9";var a=o(445),l=o(43),i=o(629),u=o.n(i),d=o(846),h=o(147),m=o(2),p=o(145),f=o(722);var k=o(579);const v={easy:{text:"\u041b\u0435\u0433\u043a\u043e \ud83e\udd13",depth:5},normal:{text:"\u041d\u043e\u0440\u043c\u0430\u043b\u044c\u043d\u043e \ud83e\uddd0",depth:8},hard:{text:"\u0421\u043b\u043e\u0436\u043d\u043e \ud83d\ude35",depth:15}};const S=e=>{let{className:n,defaultPosition:o}=e;const i=(0,m.zy)(),S=(0,l.useMemo)((()=>new URLSearchParams(i.search)),[i.search]),b=(0,l.useMemo)((()=>new(u())),[]);o=(0,l.useMemo)((()=>o||S.get(p._.chessDefaultPosition)||b.fen()),[o,S,b]);const[w,x]=(0,l.useState)(o),[_,g]=(0,l.useState)("easy"),C=(0,l.useRef)(null);function y(e){const n=b.move(e);return x(b.fen()),console.log(n),null!==n&&(b.game_over()||b.in_draw()?(h.R.checkmateSound.play(),!1):b.in_check()?(h.R.checkSound.play(),!0):"O-O-O"===n.san||"O-O"===n.san?(h.R.castlingSound.play(),!0):n.captured?(h.R.captureSound.play(),!0):(h.R.moveSound.play(),!0))}async function j(){try{const{controller:e,signal:n}=function(e){return e.current&&e.current.abort(),e.current=new AbortController,{controller:e.current,signal:e.current.signal}}(C);C.current=e;const{data:o}=await f.A.get("https://stockfish.online/api/s/v2.php",{params:{fen:b.fen(),depth:v[_].depth},signal:n});if(console.log(o),!o.success)return void console.error(o.data);const{bestMove:s,ponder:t}=function(e){const n=e.match(/^bestmove\s+(\S{4,6})/),o=n?n[1]:null,s=e.match(/\sponder\s+(\S{4,6})$/);return{bestMove:o,ponder:s?s[1]:null}}(o.bestmove);console.log(s,t);y({from:s.slice(0,2),to:s.slice(2,4),promotion:s.slice(4,6).toLowerCase()})}catch(e){throw e}finally{C.current=null}}return(0,l.useEffect)((()=>{b.load(o)}),[o,b]),(0,k.jsx)("div",{className:(0,s.x)(t,{},[n]),children:(0,k.jsxs)("div",{className:c,children:[(0,k.jsx)("div",{className:r,children:Object.entries(v).map((e=>{let[n,o]=e;return(0,k.jsx)(a.$n,{onClick:()=>g(n),theme:a.Ox.CLASSIC,active:_===n,children:o.text},"".concat(n))}))}),(0,k.jsx)(d.Ve,{id:"chessboard",position:w,onPieceDrop:function(e,n,o){console.log(e,n,o);const s=y({from:e,to:n,promotion:o[1].toLowerCase()});return s&&setTimeout((()=>{j()}),500),s}}),(0,k.jsxs)("div",{className:r,children:[(0,k.jsx)(a.$n,{onClick:()=>{b.reset(),x(b.fen())},children:"\u041d\u043e\u0432\u0430\u044f \u0438\u0433\u0440\u0430"}),(0,k.jsx)(a.$n,{onClick:()=>{b.undo(),b.undo(),x(b.fen())},children:"\u041d\u0430\u0437\u0430\u0434"})]})]})})},b=e=>{let{className:n}=e;return(0,k.jsx)("div",{children:(0,k.jsx)(S,{})})}},145:(e,n,o)=>{o.d(n,{_:()=>s});const s={chessDefaultPosition:"board-pos"}},147:(e,n,o)=>{o.d(n,{R:()=>s});const s={captureSound:new Audio("./sound/capture.mp3"),castlingSound:new Audio("./sound/castling.mp3"),checkSound:new Audio("./sound/check.mp3"),checkmateSound:new Audio("./sound/checkmate.mp3"),moveSound:new Audio("./sound/move.mp3")};for(let t of Object.keys(s))s[t].volume=.2}}]);
//# sourceMappingURL=11.93452e18.chunk.js.map