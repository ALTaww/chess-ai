"use strict";(self.webpackChunkstockfish_web=self.webpackChunkstockfish_web||[]).push([[11],{11:(e,n,s)=>{s.r(n),s.d(n,{default:()=>_});var o=s(371);const t="StockfishOnlineChessboard_StockfishOnlineChessboard__Xm861",c="StockfishOnlineChessboard_chessboardWrapper__LJGcy",a="StockfishOnlineChessboard_buttons__0Mnm9";var r=s(445),l=s(43),i=s(629),d=s.n(i),u=s(846),h=s(147),m=s(2),p=s(145),A=s(722);var v=s(801),x=s(310),f=s(579);const C={easy:{text:"\u041b\u0435\u0433\u043a\u043e \ud83e\udd13",depth:5},normal:{text:"\u041d\u043e\u0440\u043c\u0430\u043b\u044c\u043d\u043e \ud83e\uddd0",depth:8},hard:{text:"\u0421\u043b\u043e\u0436\u043d\u043e \ud83d\ude35",depth:15}};const k=e=>{let{className:n,defaultPosition:s}=e;const i=(0,m.zy)(),k=(0,l.useMemo)((()=>new URLSearchParams(i.search)),[i.search]),_=(0,l.useMemo)((()=>new(d())),[]);s=(0,l.useMemo)((()=>s||k.get(p._.chessDefaultPosition)||_.fen()),[s,k,_]);const[g,j]=(0,l.useState)(s),[w,b]=(0,l.useState)("easy"),S=(0,l.useRef)(null);function N(e){const n=_.move(e);return j(_.fen()),console.log(n),null!==n&&(_.game_over()||_.in_draw()?(h.R.checkmateSound.play(),O(!0),!1):_.in_check()?(h.R.checkSound.play(),!0):"O-O-O"===n.san||"O-O"===n.san?(h.R.castlingSound.play(),!0):n.captured?(h.R.captureSound.play(),!0):(h.R.moveSound.play(),!0))}async function y(){try{const{controller:e,signal:n}=function(e){return e.current&&e.current.abort(),e.current=new AbortController,{controller:e.current,signal:e.current.signal}}(S);S.current=e;const{data:s}=await A.A.get("https://stockfish.online/api/s/v2.php",{params:{fen:_.fen(),depth:C[w].depth},signal:n});if(console.log(s),!s.success)return void console.error(s.data);const{bestMove:o,ponder:t}=function(e){const n=e.match(/^bestmove\s+(\S{4,6})/),s=n?n[1]:null,o=e.match(/\sponder\s+(\S{4,6})$/);return{bestMove:s,ponder:o?o[1]:null}}(s.bestmove);console.log(o,t);N({from:o.slice(0,2),to:o.slice(2,4),promotion:o.slice(4,6).toLowerCase()})}catch(e){throw e}finally{S.current=null}}(0,l.useEffect)((()=>{_.load(s)}),[s,_]);const[E,O]=(0,l.useState)(!1),R=(0,l.useCallback)((()=>{O(!E)}),[E]);return(0,f.jsxs)("div",{className:(0,o.x)(t,{},[n]),children:[(0,f.jsxs)("div",{className:c,children:[(0,f.jsx)("div",{className:a,children:Object.entries(C).map((e=>{let[n,s]=e;return(0,f.jsx)(r.$n,{onClick:()=>b(n),theme:r.Ox.CLASSIC,active:w===n,children:s.text},"".concat(n))}))}),(0,f.jsx)(u.Ve,{id:"chessboard",position:g,onPieceDrop:function(e,n,s){console.log(e,n,s);const o=N({from:e,to:n,promotion:s[1].toLowerCase()});return o&&setTimeout((()=>{y()}),500),o}}),(0,f.jsxs)("div",{className:a,children:[(0,f.jsx)(r.$n,{onClick:()=>{_.reset(),j(_.fen())},children:"\u041d\u043e\u0432\u0430\u044f \u0438\u0433\u0440\u0430"}),(0,f.jsx)(r.$n,{onClick:()=>{_.undo(),_.undo(),j(_.fen())},children:"\u041d\u0430\u0437\u0430\u0434"})]}),(0,f.jsx)(x.o,{fenPosition:g,onChange:e=>{const{valid:n}=_.validate_fen(e);n&&(_.load(e),j(_.fen()))}})]}),(0,f.jsxs)(v.a,{isOpen:E,onClose:R,children:[(0,f.jsx)("p",{children:"\u0418\u0433\u0440\u0430 \u043e\u043a\u043e\u043d\u0447\u0435\u043d\u0430!"}),(0,f.jsxs)("div",{className:a,children:[(0,f.jsx)(r.$n,{onClick:()=>{_.reset(),j(_.fen()),O(!1)},children:"\u041d\u043e\u0432\u0430\u044f \u0438\u0433\u0440\u0430"}),(0,f.jsx)(r.$n,{onClick:()=>{O(!1)},children:"\u041d\u0430\u0437\u0430\u0434"})]})]})]})},_=e=>{let{className:n}=e;return(0,f.jsx)("div",{children:(0,f.jsx)(k,{})})}},145:(e,n,s)=>{s.d(n,{_:()=>o});const o={chessDefaultPosition:"board-pos"}},147:(e,n,s)=>{s.d(n,{R:()=>o});const o={captureSound:new Audio("./sound/capture.mp3"),castlingSound:new Audio("./sound/castling.mp3"),checkSound:new Audio("./sound/check.mp3"),checkmateSound:new Audio("./sound/checkmate.mp3"),moveSound:new Audio("./sound/move.mp3")};for(let t of Object.keys(o))o[t].volume=.2},310:(e,n,s)=>{s.d(n,{o:()=>m});var o=s(371);const t="FenInput_FenInput__+TRAY",c="FenInput_copyButton__j+z8x";var a=s(555),r=s(986);const l="Input_Input__hHLh7";var i=s(579);const d=["className"],u=e=>{const{className:n}=e,s=(0,r.A)(e,d);return(0,i.jsx)("input",(0,a.A)({className:(0,o.x)(l,{},[n])},s))};var h=s(445);const m=e=>{let{className:n,fenPosition:s,onChange:a}=e;return(0,i.jsxs)("div",{className:(0,o.x)(t,{},[n]),children:[(0,i.jsx)(u,{value:s,onChange:e=>{a&&a(e.target.value)},placeholder:"\u0412\u0441\u0442\u0430\u0432\u044c\u0442\u0435 \u043f\u043e\u0437\u0438\u0446\u0438\u044e FEN, \u0447\u0442\u043e\u0431\u044b \u043d\u0430\u0447\u0430\u0442\u044c \u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435"}),(0,i.jsx)(h.$n,{onClick:()=>{navigator.clipboard.writeText(s),console.log("copied")},theme:h.Ox.CLEAR,className:c,square:!0,children:(0,i.jsx)("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAADsAAAA7AF5KHG9AAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAAATVJREFUWIXt179KxEAQx/GP3pVaKPgMKhy2FmJnYWV3PoaPIIJv4L2EYCFWJ2hpow8gXC+CFgp67XkWd5E1Ekk2uT9FvhDCTjIzP3azkx1mzEJqvIwjtNCIjNnDCQZFHZt4wLCCay9G+U5FyR+xFiOgHQS5xFJMkKIsZtjP0Z+GgGaG/Ss1XsW2+Fnp4x5veQWE7OIKK5HJE95xgLvQmLUEIZ0KkhvHOEsb88xAa3wfGO3vXsHE62O/Brb+ezHcBe3Anti6BROHXAdxfpFnCRI+Swj4yHpQRMBEqAXUAmoBtYBQQFjpMitX1YQ/oxucGtXr21kIGOB4WokT5uobmHsBsY1KWd+fg8QLNiL8N/Eq40CSh2fVNCxDPKWD51mCPwfJEnTShnRzmsUh9pXrC7q4iPSfHN8P6WXseTd0UwAAAABJRU5ErkJggg==",alt:"\u041a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u0442\u044c"})})]})}},801:(e,n,s)=>{s.d(n,{a:()=>m});var o=s(371),t=s(43),c=s(950);const a=e=>{const{children:n,element:s=document.body}=e;return(0,c.createPortal)(n,s)},r="Modal_Modal__47RDU",l="Modal_overlay__lpaR1",i="Modal_content__TWhw1",d="Modal_opened__iZlPA",u="Modal_isClosing__AoAui";var h=s(579);const m=e=>{const{className:n,children:s,isOpen:c,onClose:m}=e,[p,A]=(0,t.useState)(!1),v=(0,t.useRef)(null),x=(0,t.useCallback)((()=>{m&&(A(!0),v.current=setTimeout((()=>{m(),A(!1)}),300))}),[m]),f=(0,t.useCallback)((e=>{"Escape"===e.key&&x()}),[x]);(0,t.useEffect)((()=>(console.log(""),c&&window.addEventListener("keydown",f),()=>{clearTimeout(v.current),window.removeEventListener("keydown",f)})),[c,f]);const C={[d]:c,[u]:p};return(0,h.jsx)(a,{children:(0,h.jsx)("div",{className:(0,o.x)(r,C,[n]),children:(0,h.jsx)("div",{className:l,onClick:x,children:(0,h.jsx)("div",{className:i,onClick:e=>{e.stopPropagation()},children:s})})})})}}}]);
//# sourceMappingURL=11.cf170db1.chunk.js.map